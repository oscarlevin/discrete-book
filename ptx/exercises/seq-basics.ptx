<?xml version="1.0" encoding="UTF-8"?>
<exercises permid="RXe" xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="exercises_seq_basics">
<!-- Add webwork exercises: -->
<!-- Find a_5 for some closed formulas and for some recursive formulas -->
<!-- Say whether a formula is a closed formula or a recurrence relation -->
<!-- Which recurrence relations agree with the sequence? -->
<!-- Are there two different sequences that have the same closed formula, recurrence relation, or recursive definition? -->
<!-- Something about the difference between the value and index -->
  <exercise permid="dnh">
    <webwork>
        <setup>
          <pg-code>
            Context()->variables->are(n => "Real");
            $ans1 = Formula("n^2 + 1");
            $ans2 = Formula("(n*(n-1))/2 - 1");
            $ans3 = Formula("((n+2)*(n+3))/2 + 2");
            $ans4 = Formula("(n+1)! - 1");
          </pg-code>
        </setup>
        <statement>
          <p permid="LxY">
            Find the closed formula for each of the following sequences by relating them to a well known sequence.
            Assume the first term given is <m>a_1</m>.

            <ol permid="gRH">
              <li permid="RIJ">
                <p permid="yzM">
                  <m>2, 5, 10, 17, 26, \ldots</m>
                </p>
                <instruction>
                  <m>a_n = </m> <var name="$ans1" width="10"/>
                </instruction>
              </li>

              <li permid="xPS">
                <p permid="eGV">
                  <m>0, 2, 5, 9, 14, 20, \ldots</m>
                </p>
                <instruction>
                  <m>a_n = </m> <var name="$ans2" width="10"/>
                </instruction>
              </li>

              <li permid="dXb">
                <p permid="KOe">
                  <m>8, 12, 17, 23, 30,\ldots</m>
                </p>
                <instruction>
                  <m>a_n = </m> <var name="$ans3" width="10"/>
                </instruction>
              </li>

              <li permid="Kek">
                <p permid="qVn">
                  <m>1, 5, 23, 119, 719,\ldots</m>
                </p>
                <instruction>
                  <m>a_n = </m> <var name="$ans4" width="10"/>
                </instruction>
              </li>
            </ol>
          </p>
        </statement>
        <solution permid="yVl">
          <p permid="Cem">
            <ol permid="IoX">
              <li permid="qlt">
                Note that if we subtract 1 from each term,
                we get the familiar triangular numbers.
                Thus <m>a_n = n^2 + 1</m>.
              </li>

              <li permid="WsC">
                These look like the triangular numbers, only shifted by 1.
                We get: <m>a_n = \frac{n(n+1)}{2} - 1</m>.
              </li>

              <li permid="CzL">
                If you subtract 2 from each term,
                you get triangular numbers, only starting with 6 instead of 1.
                So we must shift vertically and horizontally. <m>a_n = \frac{(n+2)(n+3)}{2} + 2</m>.
              </li>

              <li permid="iGU">
                These seem to grow very quickly.
                Further, if we add 1 to each term,
                we find the factorials, although starting with 2 instead of 1.
                This gives, <m>a_n = (n+1)! - 1</m>
                (where <m>n! = 1 \cdot 2 \cdot 3 \cdots n</m>).
              </li>
            </ol>
          </p>
        </solution>
    </webwork>
  </exercise>

  <exercise permid="Juq">
    <webwork>
        <setup>
          <pg-code>
            Context()->variables->are(n => "Real");
            $ans1 = Formula("2^n + 3");
            $ans2 = Formula("(n+1)^2 - 1");
            $ans3 = Formula("(n+2)(n+3)");
            $ans4 = Formula("(n*(n+1))/2 + n^2");
          </pg-code>
        </setup>
        <statement>
          <p permid="rFh">
            For each sequence given below,
            find a closed formula for <m>a_n</m>,
            the <m>n</m>th term of the sequence
            (assume the first terms are <m>a_0</m>)
            by relating it to another sequence for which you already know the formula.
            In each case, briefly say how you got your answers.

            <ol permid="MYQ">
              <li permid="OOd">
                <p permid="Xcw">
                  4, 5, 7, 11, 19, 35, <ellipsis/>
                </p>
                <instruction>
                  <m>a_n = </m> <var name="$ans1" width="10"/>
                </instruction>
              </li>

              <li permid="uVm">
                <p permid="DjF">
                  0, 3, 8, 15, 24, 35, <ellipsis/>
                </p>
                <instruction>
                  <m>a_n = </m> <var name="$ans2" width="10"/>
                </instruction>
              </li>

              <li permid="bcv">
                <p permid="jqO">
                  6, 12, 20, 30, 42, <ellipsis/>
                </p>
                <instruction>
                  <m>a_n = </m> <var name="$ans3" width="10"/>
                </instruction>
              </li>

              <li permid="HjE">
                <p permid="PxX">
                  0, 2, 7, 15, 26, 40, 57, <ellipsis/> (Cryptic Hint:
                  these might be called <q>house numbers</q>)
                </p>
                <instruction>
                  <m>a_n = </m> <var name="$ans4" width="10"/>
                </instruction>
              </li>
            </ol>
          </p>
        </statement>
        <solution permid="fcu">
          <p permid="ilv">
            <ol permid="owg">
              <li permid="nqN">
                <p permid="vFg">
                  If we subtract 3 from each term,
                  we get <m>1, 2, 4, 8, 16, 32, \ldots</m>,
                  which are the powers of 2.
                  So we must shift this sequence up by 3 to get our sequence.
                  Thus
                  <me permid="hgc">
                    a_n = 2^n + 3
                  </me>
                </p>
              </li>

              <li permid="TxW">
                <p permid="bMp">
                  Add 1 to each term - we get <m>1, 4, 9, 16, 25, 36, \ldots</m>,
                  the square numbers.
                  So maybe our sequence as formula <m>a_n = n^2 - 1</m>.
                  Does this work? <m>a_3 = 8</m>.
                  That is a term of our sequence,
                  but it should be <m>a_2</m>.
                  So we want
                  <me permid="Nnl">
                    a_n = (n+1)^2 - 1
                  </me>
                </p>
              </li>

              <li permid="zFf">
                <p permid="HTy">
                  Each term is even, so let's see what happens when we divide by 2:
                  we get <m>3, 6, 10, 15, 21,\ldots</m>.
                  These are the triangle numbers,
                  but starting at <m>T_2</m>.
                  We know <m>T_n = \frac{n(n+1)}{2}</m>.
                  We want <m>a_0 = 2T_2</m>, <m>a_1 = 2T_3</m>, and so on.
                  In general, <m>a_n = 2T_{n+2}</m>, so
                  <me permid="tuu">
                    a_n = (n+2)(n+3)
                  </me>
                </p>

                <p permid="oaH">
                  (This is like a shift by 2 units to the left and a stretch by a factor of 2.)
                </p>
              </li>

              <li permid="fMo">
                <p permid="UhQ">
                  How far off from triangular number are these?
                  The triangular numbers
                  (starting with <m>T_0</m>)
                  are <m>0, 1, 3, 6, 10, 15, 21, \ldots</m>.
                  The given sequence differs from this by <m>0, 1, 4, 9, 16, 25, 36, \ldots</m> the square numbers!
                  Thus
                  <me permid="ZBD">
                    a_n = \frac{n(n+1)}{2} + n^2
                  </me>
                </p>
              </li>
            </ol>
          </p>
        </solution>
    </webwork>
  </exercise>

  <exercise>
    <statement>
      <p>
        Write out the first 5 terms
        (starting with <m>a_0</m> )
        of each of the sequences described below.
        Then give either a closed formula or a recursive definition for the sequence
        (whichever is NOT given in the problem).

        <ol>
          <li>
            <p>
              <m>a_n = \frac{1}{2}(n^2 + n)</m>.
            </p>
          </li>

          <li>
            <p>
              <m>a_n = 2a_{n-1} - a_{n-2}</m> with <m>a_0 = 0</m> and <m>a_1 = 1</m>.
            </p>
          </li>

          <li>
            <p>
              <m>a_n = na_{n-1}</m> with <m>a_0 = 1</m>.
            </p>
          </li>
        </ol>
      </p>
    </statement>
    <solution>
      <p>
        <ol>
          <li>
            <p>
              <m>a_0 = 0</m>, <m>a_1 = 1</m>, <m>a_2 = 3</m>,
              <m>a_3 = 6</m> <m>a_4 = 10</m>.
              The sequence was described by a closed formula.
              These are the triangular numbers.
              A recursive definition is: <m>a_n = a_{n-1} + n</m> with <m>a_0 = 0</m>.
            </p>
          </li>

          <li>
            <p>
              This is a recursive definition.
              We continue <m>a_2 = 2</m>,
              <m>a_3 = 3</m>, <m>a_4 = 4</m>,
              <m>a_5 = 5</m>, and so on.
              A closed formula is <m>a_n = n</m>.
            </p>
          </li>

          <li>
            <p>
              We have <m>a_0 = 1</m>, <m>a_1 = 1</m>, <m>a_2 = 2</m>,
              <m>a_3 = 6</m>, <m>a_4 = 24</m>,
              <m>a_5 = 120</m>, and so on.
              The closed formula is <m>a_n = n!</m>.
            </p>
          </li>
        </ol>
      </p>
    </solution>
  </exercise>

  <exercise permid="VII">
    <statement>
      <p permid="DTz">
        The Fibonacci sequence is <m>0, 1, 1, 2, 3, 5, 8, 13, \ldots</m>
        (where <m>F_0 = 0</m>).
            <idx><h>Fibonacci sequence</h></idx>
        <ol permid="Zni">
          <li permid="wKz">
            <p permid="lgb">
              Give the recursive definition for the sequence.
            </p>
          </li>

          <li permid="cRI">
            <p permid="Rnk">
              Write out the first few terms of the sequence of partial sums:
              <m>0</m>, <m>0+1</m>, <m>0+1+1</m>,<ellipsis/>
            </p>
          </li>

          <li permid="IYR">
            <p permid="xut">
              Give a closed formula for the sequence of partial sums in terms of <m>F_n</m>

              <notation>
                <usage>F_n</usage>
                <description>the <m>n</m>th Fibonacci number</description>
              </notation>

              (for example,
              you might say <m>F_0 + F_1 + \cdots + F_n = 3F_{n-1}^2 + n</m>,
              although that is definitely not correct).
            </p>
          </li>
        </ol>
      </p>
    </statement>
    <solution permid="rqM">
      <p permid="uzN">
        <ol permid="AKy">
          <li permid="pga">
            <m>F_n = F_{n-1} + F_{n-2}</m> with <m>F_0 = 0</m> and <m>F_1 = 1</m>.
          </li>

          <li permid="Vnj"><m>0, 1, 2, 4, 7, 12, 20, \ldots</m>.</li>

          <li permid="Bus"><m>F_0 + F_1 + \cdots + F_n = F_{n+2} - 1</m>.</li>
        </ol>
      </p>
    </solution>
  </exercise>

  <exercise permid="BPR">
    <statement>
      <p permid="kaI">
        Consider the three sequences below.
        For each, find a recursive definition.
        How are these sequences related?

        <ol permid="Fur">
          <li permid="hBB"><m>2, 4, 6, 10, 16, 26, 42, \ldots</m>.</li>

          <li permid="NIK"><m>5, 6, 11, 17, 28, 45, 73, \ldots</m>.</li>

          <li permid="tPT"><m>0, 0 , 0 , 0 , 0 , 0 , 0 ,\ldots</m>.</li>
        </ol>
      </p>
    </statement>
    <solution permid="XxV">
      <p permid="aGW">
        The sequences all have the same recurrence relation:
        <m>a_n = a_{n-1} + a_{n-2}</m>
        (the same as the Fibonacci numbers).
        The only difference is the initial conditions.
      </p>
    </solution>
  </exercise>

  <exercise permid="hXa">
    <statement>
      <p permid="QhR">
        Write out the first few terms of the sequence given by <m>a_1 = 3</m>;
        <m>a_n = 2a_{n-1} + 4</m>.
        Then find a recursive definition for the sequence <m>10, 24, 52, 108, \ldots</m>.
      </p>
    </statement>
    <solution permid="DFe">
      <p permid="GOf">
        <m>3, 10, 24, 52, 108,\ldots</m>.
        The recursive definition for <m>10, 24, 52, \ldots</m> is
        <m>a_n = 2a_{n-1} + 4</m> with <m>a_1 = 10</m>.
      </p>
    </solution>
  </exercise>

  <exercise permid="Oej">
    <statement>
      <p permid="wpa">
        Write out the first few terms of the sequence given by <m>a_n = n^2 - 3n + 1</m>.
        Then find a closed formula for the sequence
        (starting with <m>a_1</m>)
        <m>0, 2, 6, 12, 20, \ldots</m>.
      </p>
    </statement>
    <solution permid="jMn">
      <p permid="mVo">
        <m>-1, -1, 1, 5, 11, 19,\ldots</m> Thus the sequence
        <m>0, 2, 6, 12, 20,\ldots</m> has closed formula <m>a_n = (n+1)^2 - 3(n+1) + 2</m>.
      </p>
    </solution>
  </exercise>

  <exercise permid="uls">
    <statement>
      <p permid="cwj">
        Show that <m>a_n = 3\cdot 2^n + 7\cdot 5^n</m> is a solution to the recurrence relation <m>a_n = 7a_{n-1} - 10a_{n-2}</m>.
        What would the initial conditions need to be for this to be the closed formula for the sequence?
      </p>
    </statement>
    <solution permid="PTw">
      <p permid="Tcx">
        This closed formula would have
        <m>a_{n-1} = 3\cdot 2^{n-1} + 7 \cdot 5^{n-1}</m> and <m>a_{n-2} = 3\cdot 2^{n-2} + 7 \cdot 5^{n-2}</m>.
        Then we would have
        <md permid="FIM">
          <mrow>7a_{n-1} - 10a_{n-2} = \amp 7(3\cdot 2^{n-1} + 7 \cdot 5^{n-1}) - 10(3\cdot 2^{n-2} + 7 \cdot 5^{n-2})</mrow>
          <mrow>= \amp 21\cdot 2^{n-1} + 49 \cdot 5^{n-1} - 30\cdot 2^{n-2} - 70 \cdot 5^{n-2})</mrow>
          <mrow>= \amp 21\cdot 2^{n-1} + 49 \cdot 5^{n-1} - 15\cdot 2^{n-1} - 14 \cdot 5^{n-1})</mrow>
          <mrow>= \amp 6\cdot 2^{n-1} + 35 \cdot 5^{n-1}</mrow>
          <mrow>= \amp 3\cdot 2^{n} + 7 \cdot 5^{n} = a_n</mrow>
        </md>.
        So the closed formula agrees with the recurrence relation.
        The closed formula has initial terms <m>a_0 = 10</m> and <m>a_1 = 41</m>.
      </p>
    </solution>
  </exercise>

  <exercise permid="asB">
    <statement>
      <p permid="IDs">
        Find a closed formula for the sequence with recursive definition
        <m>a_n = 2a_{n-1} - a_{n-2}</m> with <m>a_1 = 1</m> and <m>a_2 = 2</m>.
      </p>
    </statement>
    <solution permid="waF">
      <p permid="zjG">
        Write out the first few terms of the sequence:
        <m>1, 2, 3, 4, 5, 6,\ldots</m>.
        This is surprising at first,
        but note that we could write <m>2a_{n-1} - a_{n-2} = a_{n-1} + (a_{n-1} -a_{n-2})</m>,
        and <m>a_{n-1} - a_{n-2}</m> is just the difference between the terms.
        Initially, the difference between terms is 1, so each time we are just adding one.
        So we see that <m>a_n = n</m> is the closed formula.
      </p>
    </solution>
  </exercise>

  <exercise permid="GzK">
    <statement>
      <p permid="oKB">
        Find a recursive definition for the sequence with closed formula <m>a_n = 3 + 2n</m>.
        Bonus points if you can give a recursive definition in which makes use of two previous terms and no constants.
      </p>
    </statement>
    <solution permid="chO">
      <p permid="fqP">
        The sequence we get is <m>3, 5, 7, 9, \ldots</m>.
        One recursive definition for this is <m>a_n = a_{n-1} + 2</m> with <m>a_0 = 3</m>.
        Another option would be to take
        <m>a_n = 2a_{n-1} - a_{n-2}</m> with <m>a_0 = 3</m> and <m>a_1 = 5</m>.
      </p>
    </solution>
  </exercise>

  <exercise>
    <statement>
      <p>
        Consider bit strings with length <m>l</m> and weight <m>k</m>
        (so strings of <m>l</m> 0's and 1's, including <m>k</m> 1's).
        We know how to count the number of these for a fixed <m>l</m> and <m>k</m>.
        Now, we will count the number of strings for which the <em>sum</em>
        of the length and the weight is fixed.
        For example,
        let's count all the bit strings for which <m>l+k = 11</m>.

        <ol>
          <li>
            <p>
              Find examples of these strings of different lengths.
              What is the longest string possible?
              What is the shortest?
            </p>
          </li>

          <li>
            <p>
              How many strings are there of each of these lengths.
              Use this to count the total number of strings
              (with sum 11).
            </p>
          </li>

          <li>
            <p>
              The other approach: Let <m>n = l+p</m> vary.
              How many strings have sum <m>n = 1</m>?
              How many have sum <m>n = 2</m>?
              And so on.
              Find and explain a recurrence relation for the sequence <m>(a_n)</m> which gives the number of strings with sum <m>n</m>.
            </p>
          </li>

          <li>
            <p>
              Describe what you have found above in terms of Pascal's Triangle.
              What pattern have you discovered?
            </p>
          </li>
        </ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
        Bonus: When bees play chess,
        they use a hexagonal board like the one shown below.
        The queen bee can move one space at a time either directly to the right or angled up-right or down-right
        (but can never move leftwards).
        How many different paths can the queen take from the top left hexagon to the bottom right hexagon?
        Explain your answer, and this relates to the previous question.
        (As an example,
        there are three paths to get to the second hexagon on the bottom row.)
      </p>

      <sidebyside width="70%">

        <image xml:id="bee-chess">

            <latex-image>
              \def\r{1}
              \newcommand{\hexagon}[3]{
                \def\x{-cos{30}*\r*#1+cos{30}*#2*\r*2}
                \def\y{-\r*#1-sin{30}*\r*#1}
                \draw[thick] (\x,\y) +(90:\r) -- +(30:\r) -- +(-30:\r) -- +(-90:\r) -- +(-150:\r) -- +(150:\r) -- cycle;
                \draw (\x,\y) node{#3};
              }
              \begin{tikzpicture}[scale=.75]
              \hexagon{1}{0}{\tiny start};
              \hexagon{2}{2}{3}
              \foreach \i in {1,...,5} {
                \foreach \j in {1,2} {
                  \hexagon{\j}{\i}{};
                }
              }
              \hexagon{2}{6}{\tiny stop};
              \end{tikzpicture}
            </latex-image>
        </image>

      </sidebyside>
    </statement>
  </exercise>

</exercises>
